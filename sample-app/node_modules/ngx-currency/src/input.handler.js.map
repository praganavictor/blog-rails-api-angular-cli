{"version":3,"sources":["../../src/input.handler.ts"],"names":[],"mappings":"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","file":"input.handler.js","sourceRoot":"","sourcesContent":["import { InputService } from \"./input.service\";\n\nexport class InputHandler {\n\n  private inputService: InputService;\n  private onModelChange: Function;\n  private onModelTouched: Function;\n\n  constructor(htmlInputElement: HTMLInputElement, options: any) {\n    this.inputService = new InputService(htmlInputElement, options);\n  }\n\n  handleCut(event: any): void {\n    setTimeout(() => {\n      this.inputService.updateFieldValue();\n      this.setValue(this.inputService.value);\n      this.onModelChange(this.inputService.value);\n    }, 0);\n  }\n\n  handleInput(event: any): void {\n    let keyCode = this.inputService.rawValue.charCodeAt(this.inputService.rawValue.length - 1);\n    let rawValueLength = this.inputService.rawValue.length;\n    let rawValueSelectionEnd = this.inputService.inputSelection.selectionEnd;\n    let storedRawValueLength = this.inputService.storedRawValue.length;\n    this.inputService.rawValue = this.inputService.storedRawValue;\n\n    if (rawValueLength != rawValueSelectionEnd || Math.abs(rawValueLength - storedRawValueLength) != 1) {\n      this.setCursorPosition(event);\n      return;\n    }\n\n    if (rawValueLength < storedRawValueLength) {\n      this.inputService.removeNumber(8);\n    }\n\n    if (rawValueLength > storedRawValueLength) {\n      switch (keyCode) {\n        case 43:\n          this.inputService.changeToPositive();\n          break;\n        case 45:\n          this.inputService.changeToNegative();\n          break;\n        default:\n          if (!this.inputService.canInputMoreNumbers) {\n            return;\n          }\n\n          this.inputService.addNumber(keyCode);\n      }\n    }\n\n    this.setCursorPosition(event);\n    this.onModelChange(this.inputService.value);\n  }\n\n  handleKeydown(event: any): void {\n    let keyCode = event.which || event.charCode || event.keyCode;\n\n    if (keyCode == 8 || keyCode == 46 || keyCode == 63272) {\n      event.preventDefault();\n      let selectionRangeLength = Math.abs(this.inputService.inputSelection.selectionEnd - this.inputService.inputSelection.selectionStart);\n\n      if (selectionRangeLength == 0) {\n        this.inputService.removeNumber(keyCode);\n        this.onModelChange(this.inputService.value);\n      }\n\n      if (selectionRangeLength >= (this.inputService.rawValue.length - this.inputService.prefixLenght())) {\n        this.clearValue();\n      }\n    }\n  }\n  clearValue(){\n    this.setValue(this.inputService.isNullable() ? null : 0);\n    this.onModelChange(this.inputService.value);\n  }\n  handleKeypress(event: any): void {\n    let keyCode = event.which || event.charCode || event.keyCode;\n\n    if (keyCode === 97 && event.ctrlKey) {\n      return;\n    }\n\n    switch (keyCode) {\n      case undefined:\n      case 9:\n      case 13:\n      case 37:\n      case 39:\n        return;\n      case 43:\n        this.inputService.changeToPositive();\n        break;\n      case 45:\n        this.inputService.changeToNegative();\n        break;\n      default:\n        if (this.inputService.canInputMoreNumbers) {\n          let selectionRangeLength = Math.abs(this.inputService.inputSelection.selectionEnd - this.inputService.inputSelection.selectionStart);\n\n          if (selectionRangeLength == this.inputService.rawValue.length) {\n            this.setValue(0);\n          }\n\n          this.inputService.addNumber(keyCode);\n        }\n    }\n\n    event.preventDefault();\n    this.onModelChange(this.inputService.value);\n  }\n\n  handlePaste(event: any): void {\n    setTimeout(() => {\n      this.inputService.updateFieldValue();\n      this.setValue(this.inputService.value);\n      this.onModelChange(this.inputService.value);\n    }, 1);\n  }\n\n  updateOptions(options: any): void {\n    this.inputService.updateOptions(options);\n  }\n\n  getOnModelChange(): Function {\n    return this.onModelChange;\n  }\n\n  setOnModelChange(callbackFunction: Function): void {\n    this.onModelChange = callbackFunction;\n  }\n\n  getOnModelTouched(): Function {\n    return this.onModelTouched;\n  }\n\n  setOnModelTouched(callbackFunction: Function) {\n    this.onModelTouched = callbackFunction;\n  }\n\n  setValue(value: number): void {\n    this.inputService.value = value;\n  }\n\n  private setCursorPosition(event: any): void {\n    setTimeout(function () {\n      event.target.setSelectionRange(event.target.value.length, event.target.value.length);\n    }, 0);\n  }\n}\n"]}